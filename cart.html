{% extends 'base.html' %}

{% block title %}Cart{% endblock %}

{% block body %}
<div class="container my-5">
    <div class="row">
        {% if cart|length > 0 %}
            <h1 class="text-center mb-5 text-white">Shopping Cart</h1>

            <!-- Left Column: Cart Items -->
            <div class="col-md-8">
                <div class="card shadow-sm">
                    <div class="card-body">
                        {% for item in cart %}
                            <div class="row mb-4">
                                <div class="col-sm-3 text-center align-self-center">
                                    <img src="{{ url_for('admin.get_image', filename=item.product.product_picture.split('/')[-1]) }}"
                                         alt="product image"
                                         class="img-fluid img-thumbnail shadow-sm"
                                         height="150" width="150">
                                </div>
                                <div class="col-sm-9">
                                    <h5>{{ item.product.product_name }}</h5>

                                    <div class="my-3">
                                        <label class="me-2">Quantity:</label>
                                        <a class="minus-cart btn text-danger" pid="{{ item.id }}"><i class="fas fa-minus-square fa-lg"></i></a>
                                        <span id="quantity{{ item.id }}">{{ item.quantity }}</span>
                                        <a class="plus-cart btn text-success" pid="{{ item.id }}"><i class="fas fa-plus-square fa-lg"></i></a>
                                    </div>

                                    <div class="d-flex justify-content-between align-items-center">
                                        <p class="mb-0"><strong>Ksh {{ item.product.current_price }}</strong></p>
                                        <button class="remove-cart btn btn-outline-danger btn-sm" pid="{{ item.id }}">Remove</button>
                                    </div>
                                </div>
                            </div>
                            <hr>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Right Column: Summary -->
            <div class="col-md-4">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h4>Cart Summary</h4>
                        <hr>

                        <ul class="list-group mb-3">
                            {% for item in cart %}
                                <li class="list-group-item d-flex justify-content-between">
                                    {{ item.product.product_name }}
                                    <span>
                                        {{ item.product.current_price }} x <span id="quantity{{ item.id }}">{{ item.quantity }}</span>
                                    </span>
                                </li>
                            {% endfor %}

                            <li class="list-group-item d-flex justify-content-between">
                                Amount
                                <span>Ksh <span id="amount_tt">{{ amount }}</span></span>
                            </li>

                            <li class="list-group-item d-flex justify-content-between">
                                <div>
                                    <strong>Total</strong>
                                    <small class="text-muted d-block">(incl. shipping)</small>
                                </div>
                                <span><strong>Ksh <span id="totalamount">{{ total }}</span></strong></span>
                            </li>
                        </ul>

                        <div class="d-grid">
                            <a href="/place-order" class="btn btn-primary">Place Order</a>
                        </div>
                    </div>
                </div>
            </div>

        {% else %}
            <h1 class="text-center text-white">Your Cart is Empty</h1>
        {% endif %}
    </div>
</div>
<h1>Your Cart</h1>
{% if cart_items %}
    <ul>
        {% for item in cart_items %}
            <li>{{ item.name }} - {{ item.price }}</li>
        {% endfor %}
    </ul>
{% else %}
    <p>Your cart is empty.</p>
{% endif %}

{% endblock %}
